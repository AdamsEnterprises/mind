<template name="Discussion.DisplayComponent">
  {{#if notFound}}
    {{> NotFoundComponent}}
  {{else}}
    {{#if canClose}}
      <div class="fixed-action-btn">
        <a href="{{pathFor 'Discussion.close' params=discussion}}" class="btn-floating btn-large waves-effect waves-light red">
          <i class="large material-icons">stop</i>
        </a>
      </div>
    {{/if}}
    <div class="section discussion">
      <div class="row">
        <h4 class="col s12">
          {{> ExpandableButton}}{{discussion.title}}
        </h4>
      </div>
      {{#if discussion.description}}
        <div class="row">
          <div class="col s12 trix-content">
            {{! Remember to sanitize content in all codepaths which allow users to provide this content. }}
            {{{discussion.description}}}
          </div>
        </div>
      {{/if}}
      {{#if isExpanded}}
        <div class="row expansion">
          <div class="col s12">
            <div class="divider"></div>
            {{#with discussion}}
              {{> MetadataComponent args editButton='Discussion.EditButton'}}
            {{/with}}
          </div>
        </div>
      {{/if}}
      {{#if discussion.isClosed}}
        <div class="center-align success card-panel balance-text">
          This discussion is closed.
        </div>
        {{#if discussion.closingNote}}
          <div class="row">
            <div class="col s12 trix-content">
              {{! Remember to sanitize content in all codepaths which allow users to provide this content. }}
              {{{discussion.closingNote}}}
            </div>
          </div>
        {{/if}}
      {{/if}}
    </div>
  {{/if}}
</template>

<template name="Discussion.EditButton">
  <a href="{{pathFor 'Discussion.edit' params=data}}" class="metadata-button waves-effect waves-light btn-flat right" title="Edit"><i class="material-icons tiny">edit</i></a>
</template>

<template name="Discussion.MetadataTimestampComponent">
  {{#if discussionOpenedAt}}
    <span class="timestamp" title="{{formatDate discussionOpenedAt DEFAULT_DATETIME_FORMAT}}">opened {{fromNow discussionOpenedAt}}</span>
    {{#if discussionClosedAt}}
      <span class="timestamp" title="{{formatDate discussionClosedAt DEFAULT_DATETIME_FORMAT}}">closed {{fromNow discussionClosedAt}}</span>
    {{/if}}
  {{else}}
    <span class="timestamp" title="{{formatDate createdAt DEFAULT_DATETIME_FORMAT}}">created {{fromNow createdAt}}</span>
  {{/if}}
</template>