<template name="Discussion.EditComponent">
  {{#if notFound}}
    {{> NotFoundComponent}}
  {{else}}
    {{#if canEdit}}
      {{#if subscriptionsReady}}
        {{> Discussion.EditFormComponent discussion}}
      {{/if}}
    {{else}}
      {{> AccessDeniedComponent}}
    {{/if}}
  {{/if}}
</template>

<template name="Discussion.EditFormComponent">
  <div class="section">
    <div class="row">
      <form class="col s12" onSubmit>
        {{!-- Or canEditClosed is true, or canEditClosed, or both. This is assured by the definition of canEdit. --}}
        {{#if canOnlyEdit}}
          <div class="row">
            <div class="input-field col s12">
              <input type="text" name="title" id="edit-discussion-title" required value="{{title}}" />
              <label for="edit-discussion-title">Title</label>
            </div>
          </div>
          <div class="row">
            <div class="input-field col s12">
              {{> EditorComponent args name='description' id=($join '-' 'edit-discussion-description' _id) label='Description'}}
            </div>
          </div>
        {{else}}
          <div class="row">
            <h4 class="col s12">
              {{title}}
            </h4>
          </div>
          {{#if descriptionDisplay}}
            <div class="row">
              <div class="col s12 trix-content">
                {{! Remember to sanitize content in all codepaths which allow users to provide this content. }}
                {{{descriptionDisplay}}}
              </div>
            </div>
          {{/if}}
        {{/if}}
        {{!-- If a discussion is closed those who can close it can edit closing information. --}}
        {{#if canEditClosed}}
          <div class="row">
            <div class="col s12">
              <div class="center-align success card-panel balance-text">
                This discussion is closed.
              </div>
            </div>
          </div>
          {{> Discussion.CloseFormRowsComponent}}
        {{/if}}
        <div class="row">
          <div class="input-field col s12 center-align">
            <button type="submit" class="btn waves-effect waves-light"><i class="material-icons left">send</i>Edit discussion</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</template>
